# Manual Test Procedures: Story 1.3 - Email Authentication

**Story**: 1.3 - Email Authentication with Supabase Auth
**Test Type**: Manual Verification Procedures
**Created**: 2025-10-31
**Test Architect**: Quinn

## Overview

This document provides comprehensive manual test procedures for validating the email authentication implementation in both **local development** and **Vercel production** environments. These tests complement the 34 automated tests and verify the complete user experience, session persistence, and cross-browser compatibility.

---

## Test Environment Setup

### Local Environment Prerequisites

1. **Start Supabase Local Instance**
   ```bash
   cd c:\Users\14088\misc.inc\reality
   supabase start
   ```
   - Verify output shows "Started supabase local development setup"
   - Note the local Supabase URL (typically: http://localhost:54321)

2. **Start Next.js Development Server**
   ```bash
   pnpm dev
   ```
   - Verify server starts on http://localhost:3000
   - Check console for any startup errors

3. **Verify Environment Variables**
   - Confirm `.env.local` contains:
     - `NEXT_PUBLIC_SUPABASE_URL` (local: http://localhost:54321)
     - `NEXT_PUBLIC_SUPABASE_ANON_KEY`

4. **Database State**
   - Reset database to clean state: `supabase db reset`
   - Verify migrations applied successfully
   - Check that `public.users` table is empty

### Vercel Environment Prerequisites

1. **Access Vercel Deployment**
   - URL: https://reality-web-mauve.vercel.app (or current production URL)
   - Verify deployment is live and healthy

2. **Verify Environment Variables** (via Vercel Dashboard)
   - Confirm production environment has:
     - `NEXT_PUBLIC_SUPABASE_URL` (production Supabase URL)
     - `NEXT_PUBLIC_SUPABASE_ANON_KEY` (production key)

3. **Clean Test Data**
   - Use fresh test email addresses for each test run
   - Pattern: `test+{timestamp}@example.com` for unique emails

4. **Browser Setup**
   - Primary: Chrome (latest)
   - Secondary: Firefox, Safari, Edge (for cross-browser testing)
   - Private/Incognito mode available for session testing

---

## Test Suite 1: Signup Flow (AC1)

### Test 1.1: Successful User Signup

**Objective**: Verify new users can create accounts with valid email/password

**Local Environment Steps**:
1. Navigate to http://localhost:3000/signup
2. Verify page displays:
   - ✓ "Create Account" heading
   - ✓ "Begin your journey into reality" subheading
   - ✓ Email input field
   - ✓ Password input field
   - ✓ "Sign Up" button
   - ✓ "Already have an account? Log in" link
   - ✓ Dark space theme (black background, white text)

3. Enter test credentials:
   - Email: `test.local.001@example.com`
   - Password: `Test123!@#`

4. Click "Sign Up" button

5. **Expected Results**:
   - ✓ Button shows "Creating account..." loading state
   - ✓ Page redirects to `/dashboard` within 2-3 seconds
   - ✓ Dashboard displays "my reality" heading
   - ✓ Navbar shows user email: `test.local.001@example.com`
   - ✓ "Log out" button visible in navbar

6. **Database Verification** (Local Only):
   ```bash
   # Check auth.users table
   psql "postgresql://postgres:postgres@localhost:54322/postgres" -c "SELECT id, email FROM auth.users WHERE email = 'test.local.001@example.com';"

   # Check public.users table (trigger verification)
   psql "postgresql://postgres:postgres@localhost:54322/postgres" -c "SELECT id, created_at FROM public.users WHERE id = (SELECT id FROM auth.users WHERE email = 'test.local.001@example.com');"
   ```
   - ✓ Record exists in `auth.users`
   - ✓ Matching record exists in `public.users` (same UUID)

**Vercel Environment Steps**:
1. Navigate to https://reality-web-mauve.vercel.app/signup
2. Follow steps 2-5 from local environment
3. Use unique email: `test.vercel.001@example.com`
4. Verify same expected results (skip database verification)

**Pass Criteria**:
- [ ] Local environment: All expected results verified ✓
- [ ] Vercel environment: All expected results verified ✓
- [ ] Database trigger creates `public.users` record ✓

---

### Test 1.2: Signup Validation - Invalid Email Format

**Objective**: Verify client-side email validation prevents invalid formats

**Test Data**:
| Email Input | Expected Error |
|-------------|----------------|
| `notanemail` | "Please enter a valid email address" |
| `test@` | "Please enter a valid email address" |
| `@example.com` | "Please enter a valid email address" |
| `test @example.com` | "Please enter a valid email address" |

**Steps** (Local & Vercel):
1. Navigate to `/signup`
2. Enter invalid email from table
3. Enter valid password: `Test123!@#`
4. Click "Sign Up"

**Expected Results**:
- ✓ Error message displays immediately
- ✓ Red error box shows specific message
- ✓ No API call made (check Network tab)
- ✓ User remains on signup page

**Pass Criteria**:
- [ ] All 4 invalid email formats blocked ✓
- [ ] Appropriate error messages shown ✓
- [ ] Works identically in Local and Vercel ✓

---

### Test 1.3: Signup Validation - Weak Password

**Objective**: Verify password strength validation (minimum 6 characters)

**Test Data**:
| Password | Should Block? | Expected Error |
|----------|---------------|----------------|
| `12345` | Yes | "Password should be at least 6 characters" |
| `abc` | Yes | "Password should be at least 6 characters" |
| `123456` | No | (Successful signup) |
| `Pass@1` | No | (Successful signup) |

**Steps** (Local & Vercel):
1. Navigate to `/signup`
2. Enter valid email: `test.weak.pass.{n}@example.com`
3. Enter test password from table
4. Click "Sign Up"

**Expected Results**:
- ✓ Weak passwords: Error message displays
- ✓ Valid passwords: Redirect to dashboard

**Pass Criteria**:
- [ ] All weak passwords blocked ✓
- [ ] Valid passwords accepted ✓
- [ ] Consistent behavior Local/Vercel ✓

---

### Test 1.4: Signup Error - Duplicate Email

**Objective**: Verify system prevents duplicate account creation

**Steps** (Local):
1. Create initial account:
   - Email: `test.duplicate.001@example.com`
   - Password: `Test123!@#`
   - Verify successful signup and logout

2. Attempt duplicate signup:
   - Navigate to `/signup`
   - Enter same email: `test.duplicate.001@example.com`
   - Enter password: `Test123!@#`
   - Click "Sign Up"

**Expected Results**:
- ✓ Error message: "User already registered"
- ✓ Red error box displays
- ✓ User remains on signup page
- ✓ Can navigate to login page via "Log in" link

**Steps** (Vercel):
- Same as local, use unique email pattern

**Pass Criteria**:
- [ ] Duplicate signup prevented ✓
- [ ] Clear error messaging ✓
- [ ] User can navigate to login ✓

---

## Test Suite 2: Login Flow (AC2)

### Test 2.1: Successful Login with Valid Credentials

**Objective**: Verify existing users can authenticate successfully

**Prerequisites**: User account exists (from Test 1.1)

**Steps** (Local & Vercel):
1. Navigate to `/login`
2. Verify page displays:
   - ✓ "Welcome Back" heading
   - ✓ "Enter your reality" subheading
   - ✓ Email and password input fields
   - ✓ "Forgot password?" link
   - ✓ "Log In" button
   - ✓ "Don't have an account? Sign up" link

3. Enter credentials:
   - Email: `test.local.001@example.com` (or Vercel equivalent)
   - Password: `Test123!@#`

4. Click "Log In"

**Expected Results**:
- ✓ Button shows "Logging in..." loading state
- ✓ Redirect to `/dashboard` within 2 seconds
- ✓ Dashboard displays user email in navbar
- ✓ Session cookie set (check DevTools → Application → Cookies)

**Pass Criteria**:
- [ ] Login successful in both environments ✓
- [ ] Session established (cookie present) ✓
- [ ] Redirect to dashboard works ✓

---

### Test 2.2: Login Error - Invalid Credentials

**Objective**: Verify security against invalid login attempts

**Test Data**:
| Scenario | Email | Password | Expected Error |
|----------|-------|----------|----------------|
| Wrong password | `test.local.001@example.com` | `WrongPass123` | "Invalid email or password" |
| Non-existent user | `nonexistent@example.com` | `Test123!@#` | "Invalid email or password" |
| Empty password | `test.local.001@example.com` | `` | "Password should be at least 6 characters" |

**Steps** (Local & Vercel):
1. Navigate to `/login`
2. Enter test credentials from table
3. Click "Log In"

**Expected Results**:
- ✓ Generic error message (no user enumeration)
- ✓ User remains on login page
- ✓ No session cookie created
- ✓ No redirect occurs

**Pass Criteria**:
- [ ] All invalid attempts blocked ✓
- [ ] Generic error prevents user enumeration ✓
- [ ] Works in both environments ✓

---

### Test 2.3: Login Validation - Email Format

**Objective**: Verify client-side validation on login form

**Steps** (Local & Vercel):
1. Navigate to `/login`
2. Enter invalid email: `notanemail`
3. Enter password: `Test123!@#`
4. Click "Log In"

**Expected Results**:
- ✓ Validation error: "Please enter a valid email address"
- ✓ No API call made
- ✓ User remains on page

**Pass Criteria**:
- [ ] Client-side validation working ✓
- [ ] Consistent Local/Vercel ✓

---

## Test Suite 3: Logout Flow (AC3)

### Test 3.1: Successful Logout from Dashboard

**Objective**: Verify users can log out and session is cleared

**Prerequisites**: User logged in (from Test 2.1)

**Steps** (Local & Vercel):
1. Logged in at `/dashboard`
2. Click "Log out" button in navbar
3. Observe behavior

**Expected Results**:
- ✓ Immediate redirect to `/login`
- ✓ Session cookie removed (check DevTools)
- ✓ User email no longer in navbar
- ✓ Cannot navigate back to `/dashboard` (should redirect to `/login`)

**Verification**:
1. After logout, manually navigate to `/dashboard`
2. **Expected**: Redirect back to `/login` (middleware protection)

**Pass Criteria**:
- [ ] Logout clears session ✓
- [ ] Redirect to login page ✓
- [ ] Protected routes inaccessible ✓
- [ ] Works in both environments ✓

---

## Test Suite 4: Session Persistence (AC4)

### Test 4.1: Session Persists Across Page Refreshes

**Objective**: Verify user remains logged in after browser refresh

**Prerequisites**: User logged in at `/dashboard`

**Steps** (Local & Vercel):
1. Log in successfully
2. Navigate to `/dashboard`
3. Verify user email displayed
4. **Hard refresh** browser (Ctrl+F5 / Cmd+Shift+R)
5. Wait for page reload

**Expected Results**:
- ✓ User remains on `/dashboard` (no redirect)
- ✓ User email still displayed in navbar
- ✓ "Log out" button still visible
- ✓ No re-authentication required

**Pass Criteria**:
- [ ] Session persists after refresh ✓
- [ ] No flicker or loading state ✓
- [ ] Works in both Local and Vercel ✓

---

### Test 4.2: Session Persists Across Browser Restart

**Objective**: Verify session survives browser close/reopen (long-lived cookies)

**Prerequisites**: User logged in

**Steps** (Local & Vercel):
1. Log in successfully at `/dashboard`
2. Note session cookie expiration in DevTools
3. **Close browser completely** (all windows/tabs)
4. **Reopen browser**
5. Navigate directly to `/dashboard`

**Expected Results**:
- ✓ No redirect to `/login`
- ✓ User still authenticated
- ✓ Email displayed in navbar
- ✓ Session cookie still present

**Note**: If cookie has `Max-Age` or `Expires`, verify it's set for reasonable duration (e.g., 7 days)

**Pass Criteria**:
- [ ] Session persists after browser restart ✓
- [ ] Cookie expiration appropriate ✓
- [ ] Vercel production behavior matches local ✓

---

### Test 4.3: Session Expiration Handling

**Objective**: Verify graceful handling when session expires

**Steps** (Vercel recommended - easier to test):
1. Log in successfully
2. Wait for token to expire (default: ~1 hour)
3. Attempt to navigate or refresh page

**Alternative - Force Expiration** (Local):
1. Log in successfully
2. Open DevTools → Application → Cookies
3. Manually delete Supabase auth cookies
4. Refresh page

**Expected Results**:
- ✓ Redirect to `/login` when session invalid
- ✓ No error thrown to user
- ✓ Graceful degradation

**Pass Criteria**:
- [ ] Expired session handled gracefully ✓
- [ ] User redirected to login ✓

---

## Test Suite 5: Auth State Access (AC5)

### Test 5.1: Auth Context Provides User State

**Objective**: Verify auth state accessible throughout app

**Steps** (Local & Vercel):
1. Log in successfully
2. Navigate to `/dashboard`
3. Open browser DevTools → Console
4. Inspect page elements showing user data

**Expected Results**:
- ✓ User email displayed in navbar (from `useAuth()` hook)
- ✓ Dashboard shows authenticated state
- ✓ No console errors related to auth context
- ✓ "Log out" button functional

**Pass Criteria**:
- [ ] Auth context working ✓
- [ ] User state accessible ✓
- [ ] No errors in console ✓

---

### Test 5.2: Loading State Management

**Objective**: Verify auth loading states prevent UI flicker

**Steps** (Local & Vercel):
1. Clear cookies (logout)
2. Navigate to `/dashboard` directly
3. Observe behavior during auth check

**Expected Results**:
- ✓ Quick redirect to `/login` (middleware)
- ✓ No flash of dashboard content
- ✓ No "Not authenticated" errors

**Pass Criteria**:
- [ ] No UI flicker ✓
- [ ] Clean redirect behavior ✓

---

## Test Suite 6: Route Protection (AC6)

### Test 6.1: Unauthenticated Access to Protected Routes

**Objective**: Verify middleware redirects unauthenticated users

**Test Routes**:
- `/dashboard`
- `/captures` (if exists)

**Steps** (Local & Vercel):
1. Ensure logged out (clear cookies or use incognito)
2. Navigate directly to protected route
3. Observe redirect behavior

**Expected Results**:
- ✓ Immediate redirect to `/login`
- ✓ No flash of protected content
- ✓ URL changes to `/login`

**Pass Criteria**:
- [ ] All protected routes redirected ✓
- [ ] Works in both environments ✓
- [ ] No protected data leaked ✓

---

### Test 6.2: Authenticated Access to Public Routes

**Objective**: Verify logged-in users redirected from auth pages

**Test Routes**:
- `/login`
- `/signup`

**Steps** (Local & Vercel):
1. Log in successfully
2. Manually navigate to `/login` or `/signup`
3. Observe redirect behavior

**Expected Results**:
- ✓ Redirect to `/dashboard`
- ✓ Cannot access login/signup when authenticated
- ✓ Smooth redirect (no flash)

**Pass Criteria**:
- [ ] Auth pages inaccessible when logged in ✓
- [ ] Redirect to dashboard works ✓
- [ ] Consistent behavior Local/Vercel ✓

---

### Test 6.3: Public Route Access

**Objective**: Verify public routes accessible without auth

**Test Routes**:
- `/` (landing page)

**Steps** (Local & Vercel):
1. Ensure logged out
2. Navigate to `/`
3. Verify page loads

**Expected Results**:
- ✓ Page loads without redirect
- ✓ No authentication required
- ✓ Can navigate to `/login` or `/signup` from here

**Pass Criteria**:
- [ ] Public routes accessible ✓
- [ ] No auth requirement ✓

---

## Test Suite 7: Secure Sessions (AC7)

### Test 7.1: HTTP-Only Cookie Verification

**Objective**: Verify JWT stored in HTTP-only cookies (XSS protection)

**Steps** (Local & Vercel):
1. Log in successfully
2. Open DevTools → Application → Cookies
3. Locate Supabase auth cookies (e.g., `sb-<project>-auth-token`)

**Expected Results**:
- ✓ Cookie has `HttpOnly` flag checked
- ✓ Cookie has `Secure` flag (Vercel only - HTTPS required)
- ✓ Cookie has `SameSite=Lax` or `SameSite=Strict`

4. Open Console and attempt to read cookie:
   ```javascript
   document.cookie
   ```

**Expected Results**:
- ✓ Auth token cookie **NOT** visible in output (HTTP-only protection)

**Pass Criteria**:
- [ ] HTTP-only flag set ✓
- [ ] Secure flag set (Vercel) ✓
- [ ] JavaScript cannot access token ✓

---

### Test 7.2: HTTPS Enforcement (Vercel Only)

**Objective**: Verify production uses HTTPS for all auth operations

**Steps** (Vercel):
1. Navigate to http://reality-web-mauve.vercel.app (without 's')
2. Observe redirect behavior

**Expected Results**:
- ✓ Automatic redirect to HTTPS version
- ✓ All requests use HTTPS (check Network tab)
- ✓ Cookies only sent over secure connections

**Pass Criteria**:
- [ ] HTTPS enforced ✓
- [ ] No mixed content warnings ✓

---

### Test 7.3: XSS Protection Validation

**Objective**: Verify no auth tokens exposed to client-side JavaScript

**Steps** (Local & Vercel):
1. Log in successfully
2. Open DevTools → Console
3. Run script to search for tokens:
   ```javascript
   // Attempt to access localStorage
   console.log(localStorage);

   // Attempt to access sessionStorage
   console.log(sessionStorage);

   // Attempt to read cookies
   console.log(document.cookie);
   ```

**Expected Results**:
- ✓ No Supabase auth tokens in localStorage
- ✓ No Supabase auth tokens in sessionStorage
- ✓ No auth tokens visible in document.cookie
- ✓ All session data in HTTP-only cookies

**Pass Criteria**:
- [ ] No tokens in client-accessible storage ✓
- [ ] HTTP-only cookies used ✓
- [ ] XSS attack surface minimized ✓

---

## Test Suite 8: Type Safety (AC8)

### Test 8.1: TypeScript Compilation

**Objective**: Verify no type errors in auth implementation

**Steps** (Local):
1. Run TypeScript type checking:
   ```bash
   pnpm typecheck
   ```

**Expected Results**:
- ✓ No TypeScript errors
- ✓ All auth types properly defined
- ✓ Clean build output

**Pass Criteria**:
- [ ] Type checking passes ✓
- [ ] No `any` types in auth code ✓

---

## Cross-Browser Testing

### Test 9.1: Multi-Browser Compatibility

**Objective**: Verify auth flows work across major browsers

**Browsers to Test**:
- Chrome (latest)
- Firefox (latest)
- Safari (latest) - Mac/iOS only
- Edge (latest)

**Test Scenarios** (Quick Smoke Test per Browser):
1. Signup new user
2. Login existing user
3. Logout
4. Session persistence (refresh)

**Expected Results**:
- ✓ All flows work identically across browsers
- ✓ No browser-specific errors
- ✓ Cookies behave consistently

**Pass Criteria**:
- [ ] Chrome: All scenarios pass ✓
- [ ] Firefox: All scenarios pass ✓
- [ ] Safari: All scenarios pass ✓
- [ ] Edge: All scenarios pass ✓

---

## Performance & UX Testing

### Test 10.1: Auth Flow Performance

**Objective**: Verify auth operations complete within acceptable time

**Metrics** (Local & Vercel):

| Operation | Target | Measured (Local) | Measured (Vercel) |
|-----------|--------|------------------|-------------------|
| Signup redirect | < 3s | _____ | _____ |
| Login redirect | < 2s | _____ | _____ |
| Logout redirect | < 1s | _____ | _____ |
| Session check (middleware) | < 500ms | _____ | _____ |

**Steps**:
1. Use DevTools Network tab
2. Measure time from button click to redirect complete
3. Record in table above

**Pass Criteria**:
- [ ] All operations meet target times ✓
- [ ] Vercel performance similar to local ✓

---

### Test 10.2: Loading State UX

**Objective**: Verify good UX during async operations

**Steps** (Local & Vercel):
1. Signup: Verify button shows "Creating account..." during submission
2. Login: Verify button shows "Logging in..." during submission
3. Verify disabled state prevents double-submission

**Expected Results**:
- ✓ Clear loading indicators
- ✓ Buttons disabled during loading
- ✓ No jarring UI changes

**Pass Criteria**:
- [ ] Loading states clear ✓
- [ ] No double-submission possible ✓
- [ ] Smooth UX transitions ✓

---

## Error Handling & Edge Cases

### Test 11.1: Network Failure Handling

**Objective**: Verify graceful handling when network unavailable

**Steps** (Local):
1. Start dev server
2. Navigate to `/signup`
3. Open DevTools → Network tab
4. Enable "Offline" mode
5. Attempt to signup

**Expected Results**:
- ✓ Error message: "Unable to connect. Please try again."
- ✓ No crash or unhandled error
- ✓ User can retry when online

**Pass Criteria**:
- [ ] Offline mode handled gracefully ✓
- [ ] Clear error messaging ✓

---

### Test 11.2: Supabase Downtime Simulation

**Objective**: Verify behavior when Supabase unavailable

**Steps** (Local):
1. Stop Supabase: `supabase stop`
2. Attempt login/signup
3. Observe error handling

**Expected Results**:
- ✓ Error message displayed (not crash)
- ✓ Application remains functional for non-auth pages

**Pass Criteria**:
- [ ] Graceful degradation ✓
- [ ] No white screen of death ✓

---

## Security Testing

### Test 12.1: SQL Injection Attempt

**Objective**: Verify Supabase Auth protects against SQL injection

**Test Inputs** (Login/Signup):
```
Email: admin'--
Email: ' OR '1'='1
Email: '; DROP TABLE users;--
```

**Steps** (Local & Vercel):
1. Enter SQL injection payloads in email field
2. Attempt signup/login

**Expected Results**:
- ✓ Treated as literal strings (validation fails or "invalid credentials")
- ✓ No database errors
- ✓ No unauthorized access

**Pass Criteria**:
- [ ] All injection attempts blocked ✓
- [ ] No database corruption ✓

---

### Test 12.2: Password Exposure Prevention

**Objective**: Verify passwords never exposed in logs/network

**Steps** (Local & Vercel):
1. Open DevTools → Network tab
2. Signup with password: `MySecretPassword123`
3. Inspect signup request payload

**Expected Results**:
- ✓ Password sent to Supabase API (expected)
- ✓ HTTPS used (Vercel - encrypted)
- ✓ Password **NOT** logged to browser console
- ✓ Password **NOT** in error messages

**Pass Criteria**:
- [ ] Passwords transmitted securely ✓
- [ ] No password leakage in logs ✓

---

## Regression Testing Checklist

### Test 13.1: Quick Smoke Test (Both Environments)

**Run this test before marking story "Done"**:

**Local Environment** (5 minutes):
- [ ] Signup new user → Success
- [ ] Login with new user → Success
- [ ] Logout → Success
- [ ] Login again → Success
- [ ] Refresh dashboard → Still logged in
- [ ] Access `/dashboard` without auth → Redirected to `/login`
- [ ] `pnpm build` → Success
- [ ] `pnpm test` → All 34 tests passing

**Vercel Environment** (5 minutes):
- [ ] Signup new user → Success
- [ ] Login with new user → Success
- [ ] Logout → Success
- [ ] Login again → Success
- [ ] Refresh dashboard → Still logged in
- [ ] Access `/dashboard` without auth → Redirected to `/login`
- [ ] Check cookies: HTTP-only ✓, Secure ✓

---

## Test Results Summary

**Test Execution Date**: _______________
**Tester Name**: _______________
**Environment**: [ ] Local  [ ] Vercel  [ ] Both

### Results by Acceptance Criteria

| AC | Criteria | Test Result | Notes |
|----|----------|-------------|-------|
| AC1 | Signup Flow | [ ] PASS [ ] FAIL | |
| AC2 | Login Flow | [ ] PASS [ ] FAIL | |
| AC3 | Logout Flow | [ ] PASS [ ] FAIL | |
| AC4 | Session Persistence | [ ] PASS [ ] FAIL | |
| AC5 | Auth State Access | [ ] PASS [ ] FAIL | |
| AC6 | Route Protection | [ ] PASS [ ] FAIL | |
| AC7 | Secure Sessions | [ ] PASS [ ] FAIL | |
| AC8 | Type Safety | [ ] PASS [ ] FAIL | |

### Overall Assessment

**Local Environment**:
- Total Tests Run: _____ / 50+
- Tests Passed: _____
- Tests Failed: _____
- Status: [ ] PASS [ ] FAIL

**Vercel Environment**:
- Total Tests Run: _____ / 50+
- Tests Passed: _____
- Tests Failed: _____
- Status: [ ] PASS [ ] FAIL

### Critical Issues Found
1. _______________________________________________
2. _______________________________________________
3. _______________________________________________

### Recommendations
1. _______________________________________________
2. _______________________________________________
3. _______________________________________________

---

## Appendix: Troubleshooting

### Common Issues & Solutions

**Issue**: Signup redirects but no user in database
**Solution**: Check trigger in `20251031000006_handle_new_user.sql` is active

**Issue**: Session lost on refresh
**Solution**: Verify `@supabase/ssr` package using cookie storage correctly

**Issue**: Middleware redirect loop
**Solution**: Check middleware.ts config matcher excludes static files

**Issue**: CORS errors in Vercel
**Solution**: Verify Supabase project URL and anon key environment variables correct

**Issue**: "Invalid JWT" errors
**Solution**: Check environment variables match between .env.local and Vercel

---

## Sign-Off

**Test Architect**: Quinn
**Signature**: _______________
**Date**: _______________

**Ready for Production**: [ ] YES [ ] NO
**Gate Decision**: [ ] PASS [ ] CONCERNS [ ] FAIL [ ] WAIVED
